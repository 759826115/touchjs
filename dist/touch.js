/*! js touchjs 2016-10-21 00:18:04 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var touch=touch||{};!function(a,b){function c(a){if(T){for(var b=[],c=null,d=0,e=a.touches.length;d<e;d++)c=a.touches[d],b.push({x:c.pageX,y:c.pageY});return b}return[{x:a.pageX,y:a.pageY}]}function d(a,b){var c=b.x-a.x,d=b.y-a.y;return Math.sqrt(c*c+d*d)}function e(a){return a.touches?a.touches.length:1}function f(a,b){if(a.length>=2&&b.length>=2){var c=d(a[1],a[0]),e=d(b[1],b[0]);return e/c}return 1}function g(a,b){return 180*Math.atan2(b.y-a.y,b.x-a.x)/Math.PI}function h(a,b){var c=Math.atan((b.y-a.y)*-1/(b.x-a.x))*(180/Math.PI);return c<0?c+180:c}function i(a){var b={up:a<-45&&a>-135,down:a>=45&&a<135,left:a>=135||a<=-135,right:a>=-45&&a<=45};for(var c in b)if(b[c])return c;return null}function j(a){for(var b=0,c=0;a.offsetParent;)b+=a.offsetLeft,c+=a.offsetTop,a=a.offsetParent;return{left:b,top:c}}function k(){t=u=v=null,C=A=w=x=!1,y=!1,r={},F=!1}function l(a){return"touchmove"===a.type||"mousemove"===a.type}function m(a){return"touchend"===a.type||"mouseup"===a.type||"touchcancel"===a.type}function n(){var b=T?"touchstart touchmove touchend touchcancel":"mouseup mousedown mousemove mouseout";X(a,b,W)}var o=function(){var a=window.navigator,b=a.userAgent,c=b.match(/(Android)[\s\/]+([\d\.]+)/),d=b.match(/(iPad|iPhone|iPod)\s+OS\s([\d_\.]+)/),e=b.match(/(Windows\s+Phone)\s([\d\.]+)/),f=/WebKit\/[\d.]+/i.test(b),g=!!d&&(a.standalone?f:/Safari/i.test(b)&&!/CriOS/i.test(b)&&!/MQQBrowser/i.test(b)),h={};return c&&(h.android=!0,h.version=c[2]),d&&(h.ios=!0,h.version=d[2].replace(/_/g,"."),h.ios7=/^7/.test(h.version),"iPad"===d[1]?h.ipad=!0:"iPhone"===d[1]?(h.iphone=!0,h.iphone5=568==screen.height):"iPod"===d[1]&&(h.ipod=!0)),e&&(h.wp=!0,h.version=e[2],h.wp8=/^8/.test(h.version)),f&&(h.webkit=!0),g&&(h.safari=!0),h}(),p={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",touchcancel:"mouseout"},q={getType:function(a){return Object.prototype.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},getSelector:function(a){if(a.id)return"#"+a.id;if(a.className){var b=a.className.split(/\s+/);return"."+b.join(".")}return a===document?"body":a.tagName.toLowerCase()},matchSelector:function(a,b){return a.webkitMatchesSelector(b)},getEventListeners:function(a){return a.listeners},getPCevts:function(a){return p[a]||a},forceReflow:function(){var a=document.getElementById("domTreeOp");a||(a=document.createElement("div"),a.id="domTreeOp",document.body.appendChild(a));var b=a.parentNode,c=a.nextSibling;b.removeChild(a),b.insertBefore(a,c)},simpleClone:function(a){return JSON.parse(JSON.stringify(a))}},r={start:null,move:null,end:null},s=0,t=null,u=null,v=null,w=!1,x=!1,y=!1,z={},A=!1,B=null,C=!1,D=null,E=1,F=!1,G=[],H=0,I=0,J=0,K=null,L=0,M=[],N=function(a,b,c){c=c||{};var d,e={bubbles:!0,cancelable:!0,detail:c};"undefined"!=typeof CustomEvent?(d=new CustomEvent(b,e),a&&a.dispatchEvent(d)):(d=document.createEvent("CustomEvent"),d.initCustomEvent(b,!0,!0,c),a&&a.dispatchEvent(d))},O=function(a,b,c){a.listeners=a.listeners||{},a.listeners[b]?a.listeners[b].push(c):a.listeners[b]=[c];var d=function(a){o.ios7&&q.forceReflow(),a.originEvent=a,a.startRotate=function(){F=!0};for(var b in a.detail)"type"!==b&&(a[b]=a.detail[b]);var d=c.call(a.target,a);"undefined"==typeof d||d||(a.stopPropagation(),a.preventDefault())};c.proxy=c.proxy||{},c.proxy[b]?c.proxy[b].push(L++):c.proxy[b]=[L++],M.push(d),a.addEventListener&&a.addEventListener(b,d,!1)},P=function(a,b,c){if(c){var d=c.proxy[b];d&&d.length&&d.forEach(function(c){a.removeEventListener&&a.removeEventListener(b,M[c],!1)})}else{var e=a.listeners[b];e&&e.length&&e.forEach(function(c){a.removeEventListener(b,c,!1)})}},Q=function(a,b,c,d){var e=function(b){var e,f;b.originEvent=b,b.startRotate=function(){F=!0};for(var g in b.detail)"type"!==g&&(b[g]=b.detail[g]);var h=q.getSelector(a)+" "+c,i=q.matchSelector(b.target,h),j=q.matchSelector(b.target,h+" "+b.target.nodeName);if(!i&&j){for(o.ios7&&q.forceReflow(),e=b.target;!q.matchSelector(e,h);)e=e.parentNode;f=d.call(b.target,b),"undefined"==typeof f||f||(b.stopPropagation(),b.preventDefault())}else o.ios7&&q.forceReflow(),(i||j)&&(f=d.call(b.target,b),"undefined"==typeof f||f||(b.stopPropagation(),b.preventDefault()))};d.proxy=d.proxy||{},d.proxy[b]?d.proxy[b].push(L++):d.proxy[b]=[L++],M.push(e),a.listeners=a.listeners||{},a.listeners[b]?a.listeners[b].push(e):a.listeners[b]=[e],a.addEventListener&&a.addEventListener(b,e,!1)},R=function(a,b,c,d){if(d){var e=d.proxy[b];e.length&&e.forEach(function(c){a.removeEventListener&&a.removeEventListener(b,M[c],!1)})}else{var f=a.listeners[b];f.forEach(function(c){a.removeEventListener(b,c,!1)})}},S={tap:!0,doubleTap:!0,tapMaxDistance:10,hold:!0,holdTime:650,maxDoubleTapInterval:300,swipe:!0,swipeTime:300,swipeMinDistance:18,swipeFactor:5,drag:!0,pinch:!0,minScaleRate:0,minRotationAngle:0},T="ontouchstart"in window,U={TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",TOUCH_CANCEL:"touchcancel",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_UP:"mouseup",CLICK:"click",PINCH_START:"pinchstart",PINCH_END:"pinchend",PINCH:"pinch",PINCH_IN:"pinchin",PINCH_OUT:"pinchout",ROTATION_LEFT:"rotateleft",ROTATION_RIGHT:"rotateright",ROTATION:"rotate",SWIPE_START:"swipestart",SWIPING:"swiping",SWIPE_END:"swipeend",SWIPE_LEFT:"swipeleft",SWIPE_RIGHT:"swiperight",SWIPE_UP:"swipeup",SWIPE_DOWN:"swipedown",SWIPE:"swipe",DRAG:"drag",DRAGSTART:"dragstart",DRAGEND:"dragend",HOLD:"hold",TAP:"tap",DOUBLE_TAP:"doubletap"},V={_getAngleDiff:function(a){for(var b=parseInt(H-h(a[0],a[1]),10),c=0;Math.abs(b-I)>90&&c++<50;)I<0?b-=180:b+=180;return I=parseInt(b,10)},pinch:function(a){var b=a.target;if(S.pinch){if(!A)return;if(e(a)<2&&!m(a))return;var c=f(r.start,r.move),d=this._getAngleDiff(r.move),g={type:"",originEvent:a,scale:c,rotation:d,direction:d>0?"right":"left",fingersCount:e(a)};if(x?l(a)?(g.fingerStatus="move",N(b,U.PINCH,g)):m(a)&&(g.fingerStatus="end",N(b,U.PINCH_END,g),k()):(x=!0,g.fingerStatus="start",N(b,U.PINCH_START,g)),Math.abs(1-c)>S.minScaleRate){var h=q.simpleClone(g),i=1e-11;c>E?(E=c-i,N(b,U.PINCH_OUT,h,!1)):c<E&&(E=c+i,N(b,U.PINCH_IN,h,!1)),m(a)&&(E=1)}if(Math.abs(d)>S.minRotationAngle){var j,n=q.simpleClone(g);j=d>0?U.ROTATION_RIGHT:U.ROTATION_LEFT,N(b,j,n,!1),N(b,U.ROTATION,g)}}},rotateSingleFinger:function(a){var b=a.target;if(F&&e(a)<2){if(!r.move)return;if(G.length<2){var c=j(b);G=[{x:c.left+b.offsetWidth/2,y:c.top+b.offsetHeight/2},r.move[0]],H=parseInt(h(G[0],G[1]),10)}var d=[G[0],r.move[0]],f=this._getAngleDiff(d),g={type:"",originEvent:a,rotation:f,direction:f>0?"right":"left",fingersCount:e(a)};l(a)?g.fingerStatus="move":(m(a)||"mouseout"===a.type)&&(g.fingerStatus="end",N(b,U.PINCH_END,g),k());var i=f>0?U.ROTATION_RIGHT:U.ROTATION_LEFT;N(b,i,g),N(b,U.ROTATION,g)}},swipe:function(a){var b=a.target;if(A&&r.move&&!(e(a)>1)){var c=Date.now(),f=c-s,h=d(r.start[0],r.move[0]),j={x:r.move[0].x-z.left,y:r.move[0].y-z.top},k=g(r.start[0],r.move[0]),n=i(k),o=f/1e3,p=10*(10-S.swipeFactor)*o*o,q={type:U.SWIPE,originEvent:a,position:j,direction:n,distance:h,distanceX:r.move[0].x-r.start[0].x,distanceY:r.move[0].y-r.start[0].y,x:r.move[0].x-r.start[0].x,y:r.move[0].y-r.start[0].y,angle:k,duration:f,fingersCount:e(a),factor:p};if(S.swipe){var t=function(){var a=U;switch(n){case"up":N(b,a.SWIPE_UP,q);break;case"down":N(b,a.SWIPE_DOWN,q);break;case"left":N(b,a.SWIPE_LEFT,q);break;case"right":N(b,a.SWIPE_RIGHT,q)}};w?l(a)?(a.preventDefault(),q.fingerStatus=q.swipe="move",N(b,U.SWIPING,q),f>S.swipeTime&&f<S.swipeTime+50&&h>S.swipeMinDistance&&(t(),N(b,U.SWIPE,q,!1))):(m(a)||"mouseout"===a.type)&&(q.fingerStatus=q.swipe="end",N(b,U.SWIPE_END,q),S.swipeTime>f&&h>S.swipeMinDistance&&(t(),N(b,U.SWIPE,q,!1))):(q.fingerStatus=q.swipe="start",w=!0,N(b,U.SWIPE_START,q))}S.drag&&(y?l(a)?(q.fingerStatus=q.swipe="move",N(b,U.DRAG,q)):m(a)&&(q.fingerStatus=q.swipe="end",N(b,U.DRAGEND,q)):(q.fingerStatus=q.swipe="start",y=!0,N(b,U.DRAGSTART,q)))}},tap:function(a){var b=a.target;if(S.tap){var c=Date.now(),f=c-s,g=d(r.start[0],r.move?r.move[0]:r.start[0]);clearTimeout(B);var h=function(){if(K&&S.doubleTap&&s-J<S.maxDoubleTapInterval){var a=d(K,r.start[0]);if(a<16)return!0}return!1}();if(h)return clearTimeout(D),void N(b,U.DOUBLE_TAP,{type:U.DOUBLE_TAP,originEvent:a,position:r.start[0]});if(S.tapMaxDistance<g)return;S.holdTime>f&&e(a)<=1&&(C=!0,J=c,K=r.start[0],D=setTimeout(function(){N(b,U.TAP,{type:U.TAP,originEvent:a,fingersCount:e(a),position:K})},220))}},hold:function(a){var b=a.target;S.hold&&(clearTimeout(B),B=setTimeout(function(){if(r.start){var c=d(r.start[0],r.move?r.move[0]:r.start[0]);S.tapMaxDistance<c||C||N(b,"hold",{type:"hold",originEvent:a,fingersCount:e(a),position:r.start[0]})}},S.holdTime))}},W=function(a){var b=a.target;switch(a.type){case"touchstart":case"mousedown":G=[],A=!0,(!r.start||r.start.length<2)&&(r.start=c(a)),e(a)>=2&&(H=parseInt(h(r.start[0],r.start[1]),10)),s=Date.now(),t=a,z={};var d=b.getBoundingClientRect(),f=document.documentElement;z={top:d.top+(window.pageYOffset||f.scrollTop)-(f.clientTop||0),left:d.left+(window.pageXOffset||f.scrollLeft)-(f.clientLeft||0)},V.hold(a);break;case"touchmove":case"mousemove":if(!A||!r.start)return;r.move=c(a),e(a)>=2?V.pinch(a):F?V.rotateSingleFinger(a):V.swipe(a);break;case"touchend":case"touchcancel":case"mouseup":case"mouseout":if(!A)return;v=a,x?V.pinch(a):F?V.rotateSingleFinger(a):w?V.swipe(a):V.tap(a),k(),H=0,I=0,a.touches&&1===a.touches.length&&(A=!0,F=!0)}},X=function(){function b(a){T||(a=q.getPCevts(a)),i.forEach(function(b){Q(b,a,g,f[a])})}function c(a){T||(a=q.getPCevts(a)),i.forEach(function(b){O(b,a,f[a])})}var d,e,f,g,h=arguments;if(h.length<2||h>4)return console.error("unexpected arguments!");var i="string"===q.getType(h[0])?a.querySelectorAll(h[0]):h[0];if(i=i.length?Array.prototype.slice.call(i):[i],3===h.length&&"string"===q.getType(h[1]))return d=h[1].split(" "),e=h[2],void d.forEach(function(a){T||(a=q.getPCevts(a)),i.forEach(function(b){O(b,a,e)})});if(3!==h.length||"object"!==q.getType(h[1]))if(2!==h.length||"object"!==q.getType(h[1])){if(4===h.length&&"object"===q.getType(h[2]))return d=h[1].split(" "),e=h[3],void d.forEach(function(a){T||(a=q.getPCevts(a)),i.forEach(function(b){O(b,a,e)})});if(4===h.length){var j=i[0];return d=h[1].split(" "),g=h[2],e=h[3],void d.forEach(function(a){T||(a=q.getPCevts(a)),Q(j,a,g,e)})}}else{f=h[1];for(var k in f)c(k)}else{f=h[1],g=h[2];for(var l in f)b(l)}},Y=function(){var b,c,d=arguments;if(d.length<1||d.length>4)return console.error("unexpected arguments!");var e="string"===q.getType(d[0])?a.querySelectorAll(d[0]):d[0];if(e=e.length?Array.prototype.slice.call(e):[e],1===d.length||2===d.length)return void e.forEach(function(a){b=d[1]?d[1].split(" "):Object.keys(a.listeners),b.length&&b.forEach(function(b){T||(b=q.getPCevts(b)),P(a,b),R(a,b)})});if(3===d.length&&"function"===q.getType(d[2]))return c=d[2],void e.forEach(function(a){b=d[1].split(" "),b.forEach(function(b){T||(b=q.getPCevts(b)),P(a,b,c)})});if(3===d.length&&"string"===q.getType(d[2])){var f=d[2];return void e.forEach(function(a){b=d[1].split(" "),b.forEach(function(b){T||(b=q.getPCevts(b)),R(a,b,f)})})}return 4===d.length?(c=d[3],void e.forEach(function(a){b=d[1].split(" "),b.forEach(function(b){T||(b=q.getPCevts(b)),R(a,b,f,c)})})):void 0},Z=function(b,c,d){var e=arguments;T||(c=q.getPCevts(c));var f="string"===q.getType(e[0])?a.querySelectorAll(e[0]):e[0];f=f.length?Array.prototype.call(f):[f],f.forEach(function(a){N(a,c,d)})};n(),b.on=X,b.off=Y,b.bind=X,b.unbind=Y,b.live=X,b.die=Y,b.config=S,b.trigger=Z}(document,touch),exports.default=touch;